import{F as v}from"./FormResident-5cc02adc.js";import{A as b,T as B}from"./TitleBar-a53dcb3b.js";import{I as w}from"./InputBase-aeccb3b2.js";import{T as y}from"./TableBase-83aa94ca.js";import{B as E}from"./ButtonBase-0f30a1f8.js";import{e as g,g as R,h as I,i as x}from"./residentEstimate-643ee178.js";import{_ as F,l as k,u as A,k as C,r as D,a as c,o as T,c as N,g as l,b as S}from"./index-86322900.js";import{S as i}from"./sweetalert2.all-281a79b7.js";import"./SelectBase-eb5912e9.js";import"./reviewArea-853a61ec.js";const $={name:"FilesResidentEstimate",components:{FormResident:v,ArrowBack:b,TitleBar:B,InputBase:w,TableBase:y,ButtonBase:E},setup(){const m=k(),n=A(),p=[{label:"Id",field:"id_archivo_estimacion"},{label:"Documentos Residente",field:"ruta_archivo_residente"},{label:"Descripción",field:"descripcion_archivo"},{label:"Estado",field:"estatus_archivo"}],e=C({file:{id_estimacion:"",file:"",descripcionFile:""},filesById:[],loading:!0}),d=D([]),_=async()=>{e.loading=!0;const{data:t}=await g(m.params.residentEstimateId);e.file.id_estimacion=t.id_estimacion,a.append("id_estimacion",e.file.id_estimacion),e.loading=!1,o()},o=async()=>{const{data:t}=await R(e.file.id_estimacion);d.value=t},u=async t=>{await updateResident(t),i.fire("¡Éxito!","Residente actualizado con éxito!","success"),n.push({name:"Resident"})};let a=new FormData;const f=async()=>{try{const{value:t}=await i.fire({title:"Select file",input:"file",showCancelButton:!0,reverseButtons:!0,inputAttributes:{accept:"pdf/*","aria-label":"Upload your profile picture"}});if(t!=null){const{value:r}=await i.fire({title:"Descripción del archivo",input:"text",showCancelButton:!0,reverseButtons:!0,inputValidator:s=>{if(!s)return"El campo es requerido"}});if(r!==void 0){e.file.descripcionFile=r,e.file.file=t,a.append("archivo_estimacion ",e.file.file),a.append("descripcion_archivo ",e.file.descripcionFile);try{await I(a),o(),i.fire("¡Éxito!","!Archivo guardado con éxito!","success"),e.file.file="",e.file.descripcionFile=""}catch(s){i.fire("Error",`${s.response.data.detail}`,"error")}}}else t===null&&i.fire("No selesccionaste ningun archivo","Agrega uno para continuar","warning")}catch{}},h=[{label:"Descargar",action:async t=>{window.open(`${t.archivo_estimacion}`,"_blank")}},{label:"Eliminar",action:async t=>{i.fire({title:"¿Estás seguro que desea inactivar el documento?",text:"Esto quitará el documento",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Si, Inactivar!",reverseButtons:!0}).then(async r=>{if(r.isConfirmed)try{await x(t.id_archivo_estimacion),await o(),i.fire("¡Inactivo!","El documento se inactivó","success")}catch(s){i.fire("Error",`${s.response.data.message}`,"error")}})}}];return _(),{app:e,filesById:d,saveResident:u,featureOptions:h,formData:a,headers:p,fileUpload:f}}},q={class:"px-4 mt-10"},U={class:"px-4"};function V(m,n,p,e,d,_){const o=c("arrow-back"),u=c("title-bar"),a=c("button-base"),f=c("table-base");return T(),N("main",q,[l(o),l(u,{title:"Estimación Residente",subtitle:"Archivos"}),S("section",U,[l(a,{label:"Nuevo",onClick:n[0]||(n[0]=h=>e.fileUpload()),class:"mr-0 ml-auto mb-5"}),l(f,{options:e.featureOptions,headers:e.headers,data:e.filesById},null,8,["options","headers","data"])])])}const Q=F($,[["render",V]]);export{Q as default};
