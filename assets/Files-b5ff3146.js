import{F as A}from"./FormResident-33bbf3ca.js";import{A as k}from"./ArrowBack-e6c8a65f.js";import{T as I}from"./TitleBar-a7fd04ba.js";import{I as z}from"./InputBase-7b333c5d.js";import{T as C}from"./TableBase-6582d812.js";import{B as O}from"./auth-f1c010b2.js";import{L as P}from"./LogoutComponent-c8cac54b.js";import{a as N,g as j,h as S,i as T}from"./residentEstimate-f98c34ff.js";import{_ as E,o as n,c as d,b as a,t as B,q,u as G,m as V,r as p,a as l,d as i,f as U,g as u}from"./index-9c7881ce.js";import{S as o}from"./sweetalert2.all-281a79b7.js";import"./SelectBase-553526a4.js";import"./reviewArea-c540debc.js";import"./users-cad8f2a4.js";const L={name:"Banner",props:{title:{type:String,default:""}}},H={class:"relative isolate flex-1 items-center gap-x-6 overflow-hidden bg-gray-50 px-4 py-1.5 sm:px-2.5 sm:before:flex"},J=a("div",{class:"absolute left-[max(-7rem,calc(50%-52rem))] top-1/2 -z-10 -translate-y-1/2 transform-gpu blur-2xl","aria-hidden":"true"},[a("div",{class:"aspect-[577/310] w-[36.0625rem] bg-gradient-to-r from-[#808080] to-[#808080] opacity-30",style:{"clip-path":"polygon(74.8% 41.9%, 97.2% 73.2%, 100% 34.9%, 92.5% 0.4%, 87.5% 0%, 75% 28.6%, 58.5% 54.6%, 50.1% 56.8%, 46.9% 44%, 48.3% 17.4%, 24.7% 53.9%, 0% 27.9%, 11.9% 74.2%, 24.9% 54.1%, 68.6% 100%, 74.8% 41.9%)"}})],-1),K=a("div",{class:"absolute left-[max(45rem,calc(50%+8rem))] top-1/2 -z-10 -translate-y-1/2 transform-gpu blur-2xl","aria-hidden":"true"},[a("div",{class:"aspect-[577/310] w-[36.0625rem] bg-gradient-to-r from-[#808080] to-[#808080] opacity-30",style:{"clip-path":"polygon(74.8% 41.9%, 97.2% 73.2%, 100% 34.9%, 92.5% 0.4%, 87.5% 0%, 75% 28.6%, 58.5% 54.6%, 50.1% 56.8%, 46.9% 44%, 48.3% 17.4%, 24.7% 53.9%, 0% 27.9%, 11.9% 74.2%, 24.9% 54.1%, 68.6% 100%, 74.8% 41.9%)"}})],-1),M={class:"text-3xl text-center"};function Q(R,f,_,e,h,v){return n(),d("div",H,[J,K,a("div",null,[a("h2",M,B(_.title),1)])])}const W=E(L,[["render",Q]]),X={name:"FilesResidentEstimate",components:{FormResident:A,ArrowBack:k,TitleBar:I,InputBase:z,TableBase:C,ButtonBase:O,Banner:W,LogoutComponent:P},setup(){const R=q(),f=G(),_=[{label:"Id",field:"id_archivo_estimacion"},{label:"Nombre Archivo",field:"ruta_archivo_residente"},{label:"Descripción",field:"descripcion_archivo"}],e=V({file:{id_estimacion:"",file:"",descripcionFile:""},data:{},filesById:[],loading:!0,filesResidente:[],filesAreaRevisora:[],filesFinanzas:[],filesDGPOP:[]}),h=p([]),v=p([]),b=p([]),g=p([]),x=p([]),w=async()=>{e.loading=!0;const{data:t}=await N(R.params.residentEstimateId);e.data=t,e.file.id_estimacion=t.id_estimacion,c.append("id_estimacion",e.file.id_estimacion),e.loading=!1,s()},s=async()=>{const{data:t}=await j(e.file.id_estimacion);h.value=t,t.residente&&(v.value=t.residente),t.area_Revisora&&(b.value=t.area_Revisora),t.finanzas&&(g.value=t.finanzas),t.dgpop&&(x.value=t.dgpop)},r=async t=>{await updateResident(t),o.fire("¡Éxito!","Residente actualizado con éxito!","success"),f.push({name:"Resident"})};let c=new FormData;const D=async()=>{try{const{value:t}=await o.fire({title:"Subir Archivo",input:"file",showCancelButton:!0,reverseButtons:!0,inputAttributes:{accept:"application/pdf","aria-label":"Upload your profile picture"}});if(t!=null){const{value:y}=await o.fire({title:"Descripción del archivo",input:"text",showCancelButton:!0,reverseButtons:!0,inputValidator:m=>{if(!m)return"El campo es requerido"}});if(y!==void 0){e.file.descripcionFile=y,e.file.file=t,c.append("archivo_estimacion ",e.file.file),c.append("descripcion_archivo ",e.file.descripcionFile);try{await S(c),s(),o.fire("¡Éxito!","!Archivo guardado con éxito!","success"),e.file.file="",e.file.descripcionFile=""}catch(m){o.fire("Error",`${m.response.data.detail}`,"error")}}}else t===null&&o.fire("No selesccionaste ningun archivo","Agrega uno para continuar","warning")}catch{}},F=[{label:"Descargar",action:async t=>{window.open(`${t.archivo_estimacion}`,"_blank")}},{label:"Inactivar",action:async t=>{o.fire({title:"¿Estás seguro que desea inactivar el documento?",text:"Esto quitará el documento",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Si, Inactivar!",reverseButtons:!0}).then(async y=>{if(y.isConfirmed)try{await T(t.id_archivo_estimacion),await s(),o.fire("¡Inactivo!","El documento se inactivó","success")}catch(m){o.fire("Error",`${m.response.data.detail}`,"error")}})}}];return w(),{app:e,filesById:h,saveResident:r,featureOptions:F,formData:c,headers:_,fileUpload:D,filesResidente:v,filesAreaRevisora:b,filesDGPOP:x,filesFinanzas:g}}},Y={class:"px-4 mt-10"},Z={class:"flex justify-between"},$={class:"px-4"},ee={class:"flex flex-row justify-between"},te={class:"font-bold text-lg"},ae={class:"font-bold text-lg w-128 text-center"},ie={class:"flex content-start justify-end items-center mb-10"},oe={class:"items-center justify-center"},se=a("h1",{class:"font-bold text-lg text-center"}," Número de la Estimación ",-1),ne={class:"text-center font-semibold text-lg numEstimacion"},re={key:1,class:"flex flex-col py-px"},ce={key:2},le={key:3},de={key:4};function fe(R,f,_,e,h,v){const b=l("arrow-back"),g=l("logout-component"),x=l("title-bar"),w=l("button-base"),s=l("banner"),r=l("table-base");return n(),d("main",Y,[a("div",Z,[i(b),i(g)]),i(x,{title:"Estimación Residente",subtitle:"Archivos"}),a("section",$,[a("div",ee,[a("div",te,B(e.app.data.numero_contrato),1),a("div",ae," Objeto: "+B(e.app.data.objeto_contrato),1),a("div",ie,[a("div",oe,[se,a("p",ne,B(e.app.data.num_consecutivo_estimacion),1)])])]),e.app.data.estatus_estimacion!=="Pagada"?(n(),U(w,{key:0,label:"Nuevo",onClick:f[0]||(f[0]=c=>e.fileUpload()),class:"mr-0 ml-auto mb-5"})):u("",!0),e.filesResidente.length?(n(),d("div",re,[i(s,{title:"Documentos de Residente"}),i(r,{options:e.featureOptions,headers:e.headers,data:e.filesResidente},null,8,["options","headers","data"])])):u("",!0),e.filesAreaRevisora.length?(n(),d("div",ce,[i(s,{title:"Documentos de Área Revisora"}),i(r,{options:e.featureOptions,headers:e.headers,data:e.filesAreaRevisora},null,8,["options","headers","data"])])):u("",!0),e.filesFinanzas.length?(n(),d("div",le,[i(s,{title:"Documentos de Finanzas"}),i(r,{options:e.featureOptions,headers:e.headers,data:e.filesFinanzas},null,8,["options","headers","data"])])):u("",!0),e.filesDGPOP.length?(n(),d("div",de,[i(s,{title:"Documentos de Registro de Pago"}),i(r,{options:e.featureOptions,headers:e.headers,data:e.filesDGPOP},null,8,["options","headers","data"])])):u("",!0)])])}const Ee=E(X,[["render",fe]]);export{Ee as default};
