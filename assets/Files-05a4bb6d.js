import{F as w}from"./FormResident-90203b5b.js";import{A as y}from"./ArrowBack-62b54b5c.js";import{T as x}from"./fetchApi-19ad648d.js";import{I as g}from"./InputBase-6623a586.js";import{T as E}from"./TableBase-5d6f867f.js";import{B as R}from"./ButtonBase-61bcfff2.js";import{a as I,g as k,h as F,i as A}from"./residentEstimate-3de98119.js";import{_ as C,l as D,u as N,k as j,r as S,a as l,o as B,c as T,g as u,b as a,t as p,e as V,f as q}from"./index-83752335.js";import{S as i}from"./sweetalert2.all-281a79b7.js";import"./SelectBase-393a96e3.js";import"./reviewArea-b8c40ad7.js";import"./users-7dd1940d.js";const O={name:"FilesResidentEstimate",components:{FormResident:w,ArrowBack:y,TitleBar:x,InputBase:g,TableBase:E,ButtonBase:R},setup(){const _=D(),r=N(),h=[{label:"Id",field:"id_archivo_estimacion"},{label:"Documentos Residente",field:"ruta_archivo_residente"},{label:"Descripción",field:"descripcion_archivo"}],e=j({file:{id_estimacion:"",file:"",descripcionFile:""},data:{},filesById:[],loading:!0}),d=S([]),v=async()=>{e.loading=!0;const{data:t}=await I(_.params.residentEstimateId);e.data=t,e.file.id_estimacion=t.id_estimacion,o.append("id_estimacion",e.file.id_estimacion),e.loading=!1,s()},s=async()=>{const{data:t}=await k(e.file.id_estimacion);d.value=t},m=async t=>{await updateResident(t),i.fire("¡Éxito!","Residente actualizado con éxito!","success"),r.push({name:"Resident"})};let o=new FormData;const f=async()=>{try{const{value:t}=await i.fire({title:"Subir Archivo",input:"file",showCancelButton:!0,reverseButtons:!0,inputAttributes:{accept:"application/pdf","aria-label":"Upload your profile picture"}});if(t!=null){const{value:c}=await i.fire({title:"Descripción del archivo",input:"text",showCancelButton:!0,reverseButtons:!0,inputValidator:n=>{if(!n)return"El campo es requerido"}});if(c!==void 0){e.file.descripcionFile=c,e.file.file=t,o.append("archivo_estimacion ",e.file.file),o.append("descripcion_archivo ",e.file.descripcionFile);try{await F(o),s(),i.fire("¡Éxito!","!Archivo guardado con éxito!","success"),e.file.file="",e.file.descripcionFile=""}catch(n){i.fire("Error",`${n.response.data.detail}`,"error")}}}else t===null&&i.fire("No selesccionaste ningun archivo","Agrega uno para continuar","warning")}catch{}},b=[{label:"Descargar",action:async t=>{window.open(`${t.archivo_estimacion}`,"_blank")}},{label:"Inactivar",action:async t=>{i.fire({title:"¿Estás seguro que desea inactivar el documento?",text:"Esto quitará el documento",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Si, Inactivar!",reverseButtons:!0}).then(async c=>{if(c.isConfirmed)try{await A(t.id_archivo_estimacion),await s(),i.fire("¡Inactivo!","El documento se inactivó","success")}catch(n){i.fire("Error",`${n.response.data.detail}`,"error")}})}}];return v(),{app:e,filesById:d,saveResident:m,featureOptions:b,formData:o,headers:h,fileUpload:f}}},U={class:"px-4 mt-10"},z={class:"px-4"},P={class:"flex flex-row justify-between"},G={class:"font-bold text-lg"},H={class:"font-bold text-lg w-128 text-center"},J={class:"flex content-start justify-end items-center mb-10"},K={class:"items-center justify-center"},L=a("h1",{class:"font-bold text-lg text-center"}," Número de la Estimación ",-1),M={class:"text-center font-semibold text-lg numEstimacion"};function Q(_,r,h,e,d,v){const s=l("arrow-back"),m=l("title-bar"),o=l("button-base"),f=l("table-base");return B(),T("main",U,[u(s),u(m,{title:"Estimación Residente",subtitle:"Archivos"}),a("section",z,[a("div",P,[a("div",G,p(e.app.data.numero_contrato),1),a("div",H," Objeto: "+p(e.app.data.objeto_contrato),1),a("div",J,[a("div",K,[L,a("p",M,p(e.app.data.num_consecutivo_estimacion),1)])])]),e.app.data.estatus_estimacion!=="Pagada"?(B(),V(o,{key:0,label:"Nuevo",onClick:r[0]||(r[0]=b=>e.fileUpload()),class:"mr-0 ml-auto mb-5"})):q("",!0),u(f,{options:e.featureOptions,headers:e.headers,data:e.filesById},null,8,["options","headers","data"])])])}const re=C(O,[["render",Q]]);export{re as default};
