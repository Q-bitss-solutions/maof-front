import{I as y}from"./InputBase-394f1e33.js";import{B as x}from"./fetchApi-ac390768.js";import{S as B}from"./SelectBase-b90bb72d.js";import{f as C}from"./resident-0c63c612.js";import{f as A}from"./contract-0324433e.js";import{d as V,a as k,u as S}from"./assingResident-55d8481f.js";import{_ as R,q as b,u as h,m as v,b as m,o as f,c as u,e as i,d as o,t as F,h as w,g as I}from"./index-0f1db36f.js";import{S as g}from"./sweetalert2.all-281a79b7.js";import{_ as D}from"./PDF-a4bdfbbc.js";import{A as N}from"./ArrowBack-4510c839.js";import{T as E}from"./TitleBar-2bdb3669.js";import{L as U}from"./LogoutComponent-d813a3be.js";const j={name:"FormAssignResident",props:{editMode:{type:Boolean,default:!1},assingResident:{type:Object,default:()=>({})}},components:{InputBase:y,ButtonBase:x,SelectBase:B},setup(d,{emit:s}){b();const a=h(),e=v({assingResident:{id_contrato:"",id_residente:"",fecha_inicio_asignacion:"",fecha_fin_asignacion:"",archivo_asignacion:""},fileName:"",listResident:[],listContract:[]});let l=new FormData;d.editMode&&(e.assingResident=d.assingResident,e.fileName=d.assingResident.archivo_asignacion.split("/"));const p=async()=>{l.append("fecha_fin_asignacion",e.assingResident.fecha_fin_asignacion),g.fire({title:"Estas seguro que desea inactivar el registro?",text:"Esto inactiva la asignacion!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Inactivar!"}).then(async n=>{if(n.isConfirmed)try{await V(e.assingResident.id_asignacion_residente_contrato,l),g.fire("Eliminado!","La asignacion se inactivo","success"),a.push({name:"AssignResident"})}catch(r){g.fire("Error",`${r.response.data.detail}`,"error"),a.push({name:"AssignResident"})}})},c=async()=>{const{data:n}=await A();e.listContract=n.map(r=>({value:r.id_contrato,label:r.nombre_proyecto}))},t=async()=>{const{data:n}=await C();e.listResident=n.map(r=>({value:r.id_residente,label:r.nombre_completo}))},_=async()=>{window.open(`${e.assingResident.archivo_asignacion}`,"_blank")};return c(),t(),{app:e,formData:l,getContracts:c,getResident:t,downloadFile:_,deleteRegister:p}}},L={class:"max-w-xl mx-auto"},M={key:0,class:"flex flex-row justify-end"},T=o("div",null,[o("h4",{class:"text-2xl mt-4"},"¿Seguro de inactivar el registro?")],-1);function q(d,s,a,e,l,p){const c=m("select-base"),t=m("input-base"),_=m("button-base");return f(),u("div",L,[i(c,{id:"id_contrato",label:"Contrato",options:e.app.listContract,modelValue:e.app.assingResident.id_contrato,"onUpdate:modelValue":s[0]||(s[0]=n=>e.app.assingResident.id_contrato=n),class:"mb-3",disabled:""},null,8,["options","modelValue"]),i(c,{id:"id_residente",label:"Residente",options:e.app.listResident,class:"mb-3",modelValue:e.app.assingResident.id_residente,"onUpdate:modelValue":s[1]||(s[1]=n=>e.app.assingResident.id_residente=n),disabled:""},null,8,["options","modelValue"]),i(t,{id:"fecha_inicio_asignacion",label:"Fecha de asignación del Residente",type:"date",class:"mb-3",modelValue:e.app.assingResident.fecha_inicio_asignacion,"onUpdate:modelValue":s[2]||(s[2]=n=>e.app.assingResident.fecha_inicio_asignacion=n),disabled:""},null,8,["modelValue"]),o("div",null,[o("div",null,[i(t,{id:"archivo_asignacion",label:"Carga oficio de designación",type:"file",class:"mb-3",value:e.app.assingResident.archivo_asignacion,disabled:""},null,8,["value"])]),a.editMode===!0?(f(),u("div",M,[o("span",null,F(e.app.fileName[5]),1),o("img",{src:D,class:"w-12 h-12",onClick:s[3]||(s[3]=(...n)=>e.downloadFile&&e.downloadFile(...n)),alt:"PDF"})])):w("",!0)]),i(t,{id:"fecha_fin_asignacion",label:"Fecha de fin del Residente",type:"date",class:"mb-3",modelValue:e.app.assingResident.fecha_fin_asignacion,"onUpdate:modelValue":s[4]||(s[4]=n=>e.app.assingResident.fecha_fin_asignacion=n)},null,8,["modelValue"]),T,i(_,{label:"Inactivar",onClick:e.deleteRegister,class:"mr-0 ml-auto"},null,8,["onClick"])])}const O=R(j,[["render",q]]),P={name:"DeleteAssingResident",components:{DeleteAssignResident:O,ArrowBack:N,TitleBar:E,LogoutComponent:U},setup(){const d=b(),s=h(),a=v({assingResident:{},loading:!0}),e=async()=>{a.loading=!0;const{data:p}=await k(d.params.assingResidentId);a.assingResident=p,a.loading=!1},l=async p=>{await S(a.assingResident),g.fire("¡Éxito!","Asignacion inhabilitada con éxito!","success"),s.push({name:"AssignResident"})};return e(),{app:a,saveAssingResident:l}}},z={class:"px-4 mt-10"},G={class:"flex justify-between"},H={class:"px-4"};function J(d,s,a,e,l,p){const c=m("arrow-back"),t=m("logout-component"),_=m("title-bar"),n=m("delete-assign-resident");return f(),u("main",z,[o("div",G,[i(c),i(t)]),i(_,{title:"Asignación Residente",subtitle:"Inactivar"}),o("section",H,[e.app.loading?w("",!0):(f(),I(n,{key:0,onSubmit:e.saveAssingResident,assingResident:e.app.assingResident,"edit-mode":""},null,8,["onSubmit","assingResident"]))])])}const te=R(P,[["render",J]]);export{te as default};
