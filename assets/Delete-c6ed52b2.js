import{I as x}from"./InputBase-1ea34d0b.js";import{B}from"./fetchApi-05434c3c.js";import{S as A}from"./SelectBase-d747c329.js";import{f as C}from"./resident-76d51504.js";import{f as V}from"./contract-c054d4fa.js";import{d as k,a as S,u as D}from"./assingResident-e2ac2993.js";import{_ as R,q as b,u as h,m as v,b as l,o as f,c as u,e as i,d as o,t as w,h as y,a as F,g as I}from"./index-9c30ed32.js";import{S as g}from"./sweetalert2.all-281a79b7.js";import{_ as N}from"./PDF-a4bdfbbc.js";import{A as E}from"./ArrowBack-7090e0e5.js";import{T as j}from"./TitleBar-16e74669.js";import{L as U}from"./LogoutComponent-673ea3ac.js";import{H as L}from"./HomePage-1b1fde7e.js";const M={name:"FormAssignResident",props:{editMode:{type:Boolean,default:!1},assingResident:{type:Object,default:()=>({})}},components:{InputBase:x,ButtonBase:B,SelectBase:A},setup(r,{emit:s}){b();const m=h(),e=v({assingResident:{id_contrato:"",id_residente:"",fecha_inicio_asignacion:"",fecha_fin_asignacion:"",archivo_asignacion:""},fileName:"",listResident:[],listContract:[]});let a=new FormData;r.editMode&&(e.assingResident=r.assingResident,e.fileName=r.assingResident.archivo_asignacion.split("/"));const _=async()=>{a.append("fecha_fin_asignacion",e.assingResident.fecha_fin_asignacion),g.fire({title:"Estas seguro que desea inactivar el registro?",text:"Esto inactiva la asignacion!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Inactivar!"}).then(async n=>{if(n.isConfirmed)try{await k(e.assingResident.id_asignacion_residente_contrato,a),g.fire("Eliminado!","La asignacion se inactivo","success"),m.push({name:"AssignResident"})}catch(c){g.fire("Error",`${c.response.data.detail}`,"error"),m.push({name:"AssignResident"})}})},d=async()=>{const{data:n}=await V();e.listContract=n.map(c=>({value:c.id_contrato,label:c.nombre_proyecto}))},t=async()=>{const{data:n}=await C();e.listResident=n.map(c=>({value:c.id_residente,label:c.nombre_completo}))},p=async()=>{window.open(`${e.assingResident.archivo_asignacion}`,"_blank")};return d(),t(),{app:e,formData:a,getContracts:d,getResident:t,downloadFile:p,deleteRegister:_}}},T={class:"max-w-xl mx-auto"},q={key:0,class:"flex flex-row justify-end"},H=o("div",null,[o("h4",{class:"text-2xl mt-4"},"¿Seguro de inactivar el registro?")],-1);function P(r,s,m,e,a,_){const d=l("select-base"),t=l("input-base"),p=l("button-base");return f(),u("div",T,[i(d,{id:"id_contrato",label:"Contrato",options:e.app.listContract,modelValue:e.app.assingResident.id_contrato,"onUpdate:modelValue":s[0]||(s[0]=n=>e.app.assingResident.id_contrato=n),class:"mb-3",disabled:""},null,8,["options","modelValue"]),i(d,{id:"id_residente",label:"Residente",options:e.app.listResident,class:"mb-3",modelValue:e.app.assingResident.id_residente,"onUpdate:modelValue":s[1]||(s[1]=n=>e.app.assingResident.id_residente=n),disabled:""},null,8,["options","modelValue"]),i(t,{id:"fecha_inicio_asignacion",label:"Fecha de asignación del Residente",type:"date",class:"mb-3",modelValue:e.app.assingResident.fecha_inicio_asignacion,"onUpdate:modelValue":s[2]||(s[2]=n=>e.app.assingResident.fecha_inicio_asignacion=n),disabled:""},null,8,["modelValue"]),o("div",null,[o("div",null,[i(t,{id:"archivo_asignacion",label:"Carga oficio de designación",type:"file",class:"mb-3",value:e.app.assingResident.archivo_asignacion,disabled:""},null,8,["value"])]),m.editMode===!0?(f(),u("div",q,[o("span",null,w(e.app.fileName[5]),1),o("img",{src:N,class:"w-12 h-12",onClick:s[3]||(s[3]=(...n)=>e.downloadFile&&e.downloadFile(...n)),alt:"PDF"})])):y("",!0)]),i(t,{id:"fecha_fin_asignacion",label:"Fecha de fin del Residente",type:"date",class:"mb-3",modelValue:e.app.assingResident.fecha_fin_asignacion,"onUpdate:modelValue":s[4]||(s[4]=n=>e.app.assingResident.fecha_fin_asignacion=n)},null,8,["modelValue"]),H,i(p,{label:"Inactivar",onClick:e.deleteRegister,class:"mr-0 ml-auto"},null,8,["onClick"])])}const O=R(M,[["render",P]]),z={name:"DeleteAssingResident",components:{DeleteAssignResident:O,ArrowBack:E,TitleBar:j,HomePage:L,LogoutComponent:U},setup(){const r=F(),{rol:s}=r.getAuthData,m=b(),e=h(),a=v({assingResident:{},loading:!0}),_=async()=>{a.loading=!0;const{data:t}=await S(m.params.assingResidentId);a.assingResident=t,a.loading=!1},d=async t=>{await D(a.assingResident),g.fire("¡Éxito!","Asignacion inhabilitada con éxito!","success"),e.push({name:"AssignResident"})};return _(),{app:a,rol:s,saveAssingResident:d}}},G={class:"px-4 mt-10"},J={class:"flex justify-between"},K={class:"flex justify-center items-center"},Q={class:"text-black font-semibold mr-4 items-center content-center"},W={class:"px-4"};function X(r,s,m,e,a,_){const d=l("arrow-back"),t=l("home-page"),p=l("logout-component"),n=l("title-bar"),c=l("delete-assign-resident");return f(),u("main",G,[o("div",J,[i(d),o("div",K,[o("p",Q,w(e.rol),1),i(t),i(p)])]),i(n,{title:"Asignación Residente",subtitle:"Inactivar"}),o("section",W,[e.app.loading?y("",!0):(f(),I(c,{key:0,onSubmit:e.saveAssingResident,assingResident:e.app.assingResident,"edit-mode":""},null,8,["onSubmit","assingResident"]))])])}const re=R(z,[["render",X]]);export{re as default};
