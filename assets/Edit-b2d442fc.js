import{I as B}from"./InputBase-89edb71c.js";import{B as C}from"./ButtonBase-313575ac.js";import{S as j}from"./SelectBase-2d1bc0d1.js";import{T as w}from"./TextAreaBase-4d502363.js";import{A as z,T as R}from"./TitleBar-793bd359.js";import{u as A,d as k,c as F,e as T}from"./residentEstimate-6b5d674a.js";import{_ as v,u as h,k as x,a as _,o as f,c as g,b as r,t as b,g as o,e as y,f as V,F as U,l as I}from"./index-ce9b0eb4.js";import{S as l}from"./sweetalert2.all-281a79b7.js";const S={name:"FormResidentEstimate",props:{editMode:{type:Boolean,default:!1},residentEstimate:{type:Object,default:()=>({})}},components:{InputBase:B,ButtonBase:C,SelectBase:j,TextAreaBase:w},setup(n){const i=h(),a=x({residentEstimate:{id_contrato:"",fecha_recepcion_info_contratista:"",fecha_autorizacion_contratista:"",fecha_periodo_inicio_estimacion:"",fecha_periodo_fin_estimacion:"",importe_obra_ejecutada:"",importe_pagar:"",grado_avance_obra:"",porcentaje_avance_estimacion:"",porcentaje_avance_estimacion_acumulado:"",porcentaje_Avance_fisico:"",porcensaje_avance_financiero:"",observaciones_residente:""},fecha_recepcion_info_contratista:"",fecha_autorizacion_contratista:"",fecha_periodo_inicio_estimacion:"",fecha_periodo_fin_estimacion:"",contratoName:"",estatus_semaforo:"",fileInfo:{type:Object,default:()=>({})},listReviewAreas:[],listEmpleados:[],listContrato:[]}),e=c=>{let t=[];return t=c.split(" "),t=t[0].split("-"),t=t[0]+"-"+t[1]+"-"+t[2],c=t,c};return n.editMode&&(console.log("props.residentEstimate: ",n.residentEstimate),console.log("props: ",n),a.residentEstimate=n.residentEstimate,a.estatus_semaforo=n,a.fecha_recepcion_info_contratista=e(n.residentEstimate.fecha_recepcion_info_contratista),n.residentEstimate.fecha_autorizacion_contratista===null?a.fecha_autorizacion_contratista=null:a.fecha_autorizacion_contratista=e(n.residentEstimate.fecha_autorizacion_contratista),a.fecha_periodo_inicio_estimacion=e(n.residentEstimate.fecha_periodo_inicio_estimacion),a.fecha_periodo_fin_estimacion=e(n.residentEstimate.fecha_periodo_fin_estimacion)),{app:a,editForm:()=>{var t=new Date().toLocaleTimeString("en-GB");console.log(t),a.residentEstimate.fecha_recepcion_info_contratista=a.fecha_recepcion_info_contratista+" "+t,a.fecha_autorizacion_contratista===null||a.fecha_autorizacion_contratista===""?delete a.residentEstimate.fecha_autorizacion_contratista:a.residentEstimate.fecha_autorizacion_contratista=a.fecha_autorizacion_contratista+" "+t,a.residentEstimate.fecha_periodo_inicio_estimacion=a.fecha_periodo_inicio_estimacion+" "+t,a.residentEstimate.fecha_periodo_fin_estimacion=a.fecha_periodo_fin_estimacion+" "+t,l.fire({title:"¿Confirma los cambios ?",icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonColor:"#3085d6",confirmButtonText:"Continuar",reverseButtons:!0}).then(async E=>{if(E.isConfirmed)try{console.log("residentEstimate put: ",a.residentEstimate),await A(a.residentEstimate),l.fire("¡Éxito!","Actualización con éxito!","success"),i.push({name:"ResidentEstimate"})}catch(p){console.log("error: ",p.response.data.detail),l.fire("Error",`${p.response.data.detail}`,"error")}})},deleteForm:()=>{l.fire({title:"¿Confirma los cambios ?",icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonColor:"#3085d6",confirmButtonText:"Continuar",reverseButtons:!0}).then(async c=>{if(c.isConfirmed)try{console.log("app.residentEstimate.observaciones_residente: ",a.residentEstimate.observaciones_residente),console.log("app.residentEstimate.id_estimacion: ",a.residentEstimate.id_estimacion),await k(a.residentEstimate,a.residentEstimate.id_estimacion),l.fire("¡Éxito!","Actualización con éxito!","success"),i.push({name:"ResidentEstimate"})}catch(t){console.log("error: ",t.response.data.detail),l.fire("Error",`${t.response.data.detail}`,"error")}})},sendReviewArea:()=>{var t=new Date().toLocaleTimeString("en-GB");a.fecha_autorizacion_contratista===null?delete a.residentEstimate.fecha_autorizacion_contratista:a.residentEstimate.fecha_autorizacion_contratista=a.fecha_autorizacion_contratista+" "+t,l.fire({title:"Se realizará el envio de la Estimación al área revisora",icon:"question",showCancelButton:!0,text:"¿Está usted seguro?",cancelButtonColor:"#d33",confirmButtonColor:"#3085d6",confirmButtonText:"Continuar",reverseButtons:!0}).then(async E=>{if(E.isConfirmed)try{await F(a.residentEstimate),l.fire("¡Éxito!","Estimación enviada al área revisora con éxito!","success"),i.push({name:"ResidentEstimate"})}catch(p){console.log("error: ",p.response.data.detail),l.fire("Error",`${p.response.data.detail}`,"error")}})},goToArchivos:()=>i.push({name:"FilesResidentEstimate",params:{residentEstimateId:a.residentEstimate.id_estimacion}}),formatFecha:e}}},N={class:"flex flex-row justify-between"},D={class:"font-bold text-lg"},O={class:"font-bold text-lg w-128"},q={class:"flex content-start justify-end items-center mb-10"},M={class:"items-center justify-center"},G=r("h1",{class:"font-bold text-lg text-center"}," Número de la Estimación ",-1),L={class:"text-center font-semibold text-lg numEstimacion"},P={class:"max-w-xl mx-auto"},H={class:"flex flex-row"},J={class:"flex justify-between items-center py-4"};function K(n,i,a,e,u,d){const m=_("button-base"),s=_("input-base"),c=_("text-area-base");return f(),g(U,null,[r("div",N,[r("div",D,b(e.app.residentEstimate.numero_contrato),1),r("div",O," Objeto: "+b(e.app.residentEstimate.objeto_contrato),1),r("div",q,[r("div",M,[G,r("p",L,b(e.app.residentEstimate.num_consecutivo_estimacion),1)])])]),o(m,{label:"Archivos",onClick:e.goToArchivos,class:"mb-3 mr-0 ml-auto"},null,8,["onClick"]),r("div",P,[o(s,{id:"fecha_recepcion_info_contratista",label:"Fecha de recepción de información del Contratista",type:"date",class:"mb-3",modelValue:e.app.fecha_recepcion_info_contratista,"onUpdate:modelValue":i[0]||(i[0]=t=>e.app.fecha_recepcion_info_contratista=t)},null,8,["modelValue"]),o(s,{id:"fecha_autorizacion_contratista",label:"Fecha de autorización al Contratista",type:"date",class:"mb-3",modelValue:e.app.fecha_autorizacion_contratista,"onUpdate:modelValue":i[1]||(i[1]=t=>e.app.fecha_autorizacion_contratista=t),disabled:e.app.residentEstimate.fecha_autorizacion_contratista!==null},null,8,["modelValue","disabled"]),r("div",H,[r("div",null,[o(s,{id:"fecha_periodo_inicio_estimacion",label:"Período de la Estimación",type:"date",modelValue:e.app.fecha_periodo_inicio_estimacion,"onUpdate:modelValue":i[2]||(i[2]=t=>e.app.fecha_periodo_inicio_estimacion=t)},null,8,["modelValue"])]),r("div",null,[o(s,{id:"fecha_periodo_fin_estimacion",label:"al",type:"date",class:"pt-2",modelValue:e.app.fecha_periodo_fin_estimacion,"onUpdate:modelValue":i[3]||(i[3]=t=>e.app.fecha_periodo_fin_estimacion=t)},null,8,["modelValue"])])]),o(s,{id:"importe_obra_ejecutada",label:"Importe de la obra ejecutada",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.importe_obra_ejecutada,"onUpdate:modelValue":i[4]||(i[4]=t=>e.app.residentEstimate.importe_obra_ejecutada=t)},null,8,["modelValue"]),o(s,{id:"importe_pagar",label:"Importe a pagar",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.importe_pagar,"onUpdate:modelValue":i[5]||(i[5]=t=>e.app.residentEstimate.importe_pagar=t)},null,8,["modelValue"]),o(s,{id:"grado_avance_obra",label:"% de grado de avance",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.grado_avance_obra,"onUpdate:modelValue":i[6]||(i[6]=t=>e.app.residentEstimate.grado_avance_obra=t)},null,8,["modelValue"]),o(s,{id:"porcentaje_avance_estimacion",label:"% de avance de la Estimación",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.porcentaje_avance_estimacion,"onUpdate:modelValue":i[7]||(i[7]=t=>e.app.residentEstimate.porcentaje_avance_estimacion=t)},null,8,["modelValue"]),o(s,{id:"porcentaje_avance_estimacion_acumulado",label:"% de avance de la Estimación acumulado",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.porcentaje_avance_estimacion_acumulado,"onUpdate:modelValue":i[8]||(i[8]=t=>e.app.residentEstimate.porcentaje_avance_estimacion_acumulado=t)},null,8,["modelValue"]),o(s,{id:"porcentaje_Avance_fisico",label:"% de avance físico",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.porcentaje_Avance_fisico,"onUpdate:modelValue":i[9]||(i[9]=t=>e.app.residentEstimate.porcentaje_Avance_fisico=t)},null,8,["modelValue"]),o(s,{id:"porcensaje_avance_financiero",label:"% de avance financiero",type:"number",class:"mb-3",modelValue:e.app.residentEstimate.porcensaje_avance_financiero,"onUpdate:modelValue":i[10]||(i[10]=t=>e.app.residentEstimate.porcensaje_avance_financiero=t)},null,8,["modelValue"]),o(c,{id:"fecha_inicio_proyecto",label:"Observaciones del Residente",class:"mb-3",modelValue:e.app.residentEstimate.observaciones_residente,"onUpdate:modelValue":i[11]||(i[11]=t=>e.app.residentEstimate.observaciones_residente=t)},null,8,["modelValue"]),r("div",J,[o(m,{label:"Actualizar Datos",class:"px-4",onClick:e.editForm},null,8,["onClick"]),o(m,{label:"Eliminar Estimacion",class:"px-4",onClick:e.deleteForm},null,8,["onClick"]),e.app.residentEstimate.estatus_semaforo==="Residente"?(f(),y(m,{key:0,label:"Enviar al area revisora",class:"px-4",onClick:e.sendReviewArea},null,8,["onClick"])):V("",!0)])])],64)}const Q=v(S,[["render",K]]),W={name:"EditResident",components:{FormResidentEstimate:Q,ArrowBack:z,TitleBar:R},setup(){const n=I(),i=h(),a=x({residentEstimate:{},loading:!0}),e=async()=>{a.loading=!0;const{data:d}=await T(n.params.residentEstimateId);console.log("data: ",d),a.residentEstimate=d,console.log("app.residentEstimate: ",a.residentEstimate),a.loading=!1},u=async d=>{await updateResident(d),l.fire("¡Éxito!","!Estimación residente actualizado con éxito!","success"),i.push({name:"Resident"})};return e(),{app:a,saveResident:u}}},X={class:"px-4 mt-10"},Y={class:"px-4"};function Z(n,i,a,e,u,d){const m=_("arrow-back"),s=_("title-bar"),c=_("form-resident-estimate");return f(),g("main",X,[o(m),o(s,{title:"Semaforos Estimación Residente",subtitle:"Editar"}),r("section",Y,[e.app.loading?V("",!0):(f(),y(c,{key:0,residentEstimate:e.app.residentEstimate,editMode:""},null,8,["residentEstimate"]))])])}const re=v(W,[["render",Z]]);export{re as default};
