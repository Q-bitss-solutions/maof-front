import{I as C}from"./InputBase-c469d919.js";import{B as w}from"./fetchApi-c943dcd0.js";import{S as x}from"./SelectBase-dd901550.js";import{f as A}from"./resident-94bff9a2.js";import{f as B}from"./contract-0b747e5e.js";import{d as V,a as k,u as S}from"./assingResident-a02410e4.js";import{_ as R,G as b,u as v,r as h,f as p,g as u,l as f,v as t,q as r,t as F,x as y,j as I}from"./index-5cc367f2.js";import{S as _}from"./sweetalert2.all-281a79b7.js";import{_ as D}from"./PDF-a4bdfbbc.js";import{T as N}from"./TitleBar-39daad40.js";import{C as E}from"./CustomHeaderApp-8d94f481.js";import"./ArrowBack-8ac6e4dd.js";import"./HomePage-555195f2.js";import"./LogoutComponent-f4751eee.js";const U={name:"FormAssignResident",props:{editMode:{type:Boolean,default:!1},assingResident:{type:Object,default:()=>({})}},components:{InputBase:C,ButtonBase:w,SelectBase:x},setup(o,{emit:s}){b();const i=v(),e=h({assingResident:{id_contrato:"",id_residente:"",fecha_inicio_asignacion:"",fecha_fin_asignacion:"",archivo_asignacion:""},fileName:"",listResident:[],listContract:[]});let d=new FormData;o.editMode&&(e.assingResident=o.assingResident,e.fileName=o.assingResident.archivo_asignacion.split("/"));const m=async()=>{d.append("fecha_fin_asignacion",e.assingResident.fecha_fin_asignacion),_.fire({title:"Estas seguro que desea inactivar el registro?",text:"Esto inactiva la asignacion!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Inactivar!"}).then(async n=>{if(n.isConfirmed)try{await V(e.assingResident.id_asignacion_residente_contrato,d),_.fire("Eliminado!","La asignacion se inactivo","success"),i.push({name:"AssignResident"})}catch(c){_.fire("Error",`${c.response.data.detail}`,"error"),i.push({name:"AssignResident"})}})},l=async()=>{const{data:n}=await B();e.listContract=n.map(c=>({value:c.id_contrato,label:c.nombre_proyecto}))},a=async()=>{const{data:n}=await A();e.listResident=n.map(c=>({value:c.id_residente,label:c.nombre_completo}))},g=async()=>{window.open(`${e.assingResident.archivo_asignacion}`,"_blank")};return l(),a(),{app:e,formData:d,getContracts:l,getResident:a,downloadFile:g,deleteRegister:m}}},j={class:"max-w-xl mx-auto"},H={key:0,class:"flex flex-row justify-end"},M=r("div",null,[r("h4",{class:"text-2xl mt-4"},"¿Seguro de inactivar el registro?")],-1);function T(o,s,i,e,d,m){const l=p("select-base"),a=p("input-base"),g=p("button-base");return u(),f("div",j,[t(l,{id:"id_contrato",label:"Contrato",options:e.app.listContract,modelValue:e.app.assingResident.id_contrato,"onUpdate:modelValue":s[0]||(s[0]=n=>e.app.assingResident.id_contrato=n),class:"mb-3",disabled:""},null,8,["options","modelValue"]),t(l,{id:"id_residente",label:"Residente",options:e.app.listResident,class:"mb-3",modelValue:e.app.assingResident.id_residente,"onUpdate:modelValue":s[1]||(s[1]=n=>e.app.assingResident.id_residente=n),disabled:""},null,8,["options","modelValue"]),t(a,{id:"fecha_inicio_asignacion",label:"Fecha de asignación del Residente",type:"date",class:"mb-3",modelValue:e.app.assingResident.fecha_inicio_asignacion,"onUpdate:modelValue":s[2]||(s[2]=n=>e.app.assingResident.fecha_inicio_asignacion=n),disabled:""},null,8,["modelValue"]),r("div",null,[r("div",null,[t(a,{id:"archivo_asignacion",label:"Carga oficio de designación",type:"file",class:"mb-3",value:e.app.assingResident.archivo_asignacion,disabled:""},null,8,["value"])]),i.editMode===!0?(u(),f("div",H,[r("span",null,F(e.app.fileName[5]),1),r("img",{src:D,class:"w-12 h-12",onClick:s[3]||(s[3]=(...n)=>e.downloadFile&&e.downloadFile(...n)),alt:"PDF"})])):y("",!0)]),t(a,{id:"fecha_fin_asignacion",label:"Fecha de fin del Residente",type:"date",class:"mb-3",modelValue:e.app.assingResident.fecha_fin_asignacion,"onUpdate:modelValue":s[4]||(s[4]=n=>e.app.assingResident.fecha_fin_asignacion=n)},null,8,["modelValue"]),M,t(g,{label:"Inactivar",onClick:e.deleteRegister,class:"mr-0 ml-auto"},null,8,["onClick"])])}const q=R(U,[["render",T]]),G={name:"DeleteAssingResident",components:{DeleteAssignResident:q,TitleBar:N,CustomHeaderApp:E},setup(){const o=b(),s=v(),i=h({assingResident:{},loading:!0}),e=async()=>{i.loading=!0;const{data:m}=await k(o.params.assingResidentId);i.assingResident=m,i.loading=!1},d=async m=>{await S(i.assingResident),_.fire("¡Éxito!","Asignacion inhabilitada con éxito!","success"),s.push({name:"AssignResident"})};return e(),{app:i,saveAssingResident:d}}},L={class:"px-4 mt-10"},O={class:"px-4"};function P(o,s,i,e,d,m){const l=p("CustomHeaderApp"),a=p("title-bar"),g=p("delete-assign-resident");return u(),f("main",L,[t(l),t(a,{title:"Asignación Residente",subtitle:"Inactivar"}),r("section",O,[e.app.loading?y("",!0):(u(),I(g,{key:0,onSubmit:e.saveAssingResident,assingResident:e.app.assingResident,"edit-mode":""},null,8,["onSubmit","assingResident"]))])])}const te=R(G,[["render",P]]);export{te as default};
