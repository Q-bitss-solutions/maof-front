import{I as c}from"./InputBase-c469d919.js";import{T as b}from"./TextAreaBase-bd244fd9.js";import{B as u}from"./fetchApi-c943dcd0.js";import{S as f}from"./SelectBase-dd901550.js";import{f as A}from"./reviewArea-476ce35e.js";import{f as v}from"./contractor-225c024e.js";import{a as V,f as y}from"./contract-0b747e5e.js";import{f as C}from"./project-32c9c971.js";import{_ as z,r as x,f as p,g as w,l as B,v as r}from"./index-5cc367f2.js";const U={name:"FormAmendingAgreement",props:{editMode:{type:Boolean,default:!1},amendingAgreement:{type:Object,default:()=>({})}},components:{InputBase:c,ButtonBase:u,SelectBase:f,TextAreaBase:b},setup(d,{emit:n}){const o=x({amendingAgreement:{numero_contrato:"",id_contratista:"",id_area_revisora:"",id_proyecto:"",id_contrato_padre:"",id_tipo_contrato:3,monto_sin_iva:"",plazo_inicio:"",plazo_fin:"",objeto_contrato:""},idAreaRevisora:"",listReviewAreas:[],listContratista:[],listConvenioContrato:[],listProyects:[]});d.editMode&&(o.amendingAgreement=d.amendingAgreement,o.amendingAgreement.plazo_inicio=d.amendingAgreement.plazo_inicio.split("/").reverse().join("-"),o.amendingAgreement.plazo_fin=d.amendingAgreement.plazo_fin.split("/").reverse().join("-"));const a=()=>n("submit",o.amendingAgreement),_=async()=>{const{data:t}=await A();o.listReviewAreas=t.map(e=>({value:e.id,label:`${e.id_unidad_maof} - ${e.nombre_unidad}`})),o.listReviewAreas.sort((e,i)=>e.label>i.label?1:e.label<i.label?-1:0)},g=async()=>{const{data:t}=await v();t.forEach(e=>{e.estatus_contratista==="Activo"&&o.listContratista.push({value:e.id_contratista,label:e.nombre_contratista})}),o.listContratista.sort((e,i)=>e.label>i.label?1:e.label<i.label?-1:0)},m=async()=>{const{data:t}=await V(o.amendingAgreement.id_contrato_padre);o.amendingAgreement.id_proyecto=t.id_proyecto,o.amendingAgreement.id_contratista=t.id_contratista,o.amendingAgreement.id_area_revisora=t.id_area_revisora},l=async()=>{const{data:t}=await C();o.listProyects=t.map(e=>({value:e.id_proyecto,label:`${e.clave_cartera} - ${e.nombre_proyecto}`})),o.listProyects.sort((e,i)=>e.label>i.label?1:e.label<i.label?-1:0)},s=async()=>{const{data:t}=await y();o.listConvenioContrato=t.map(e=>({value:e.id_contrato,label:`${e.id_contrato} - ${e.numero_contrato}`})),o.listConvenioContrato.sort((e,i)=>e.label>i.label?1:e.label<i.label?-1:0)};return _(),g(),s(),l(),{app:o,sendForm:a,getReviewAreas:_,getContratistas:g,getContracts:s,getInfoContrato:m,getProjects:l}}},j={class:"max-w-xl mx-auto"};function P(d,n,o,a,_,g){const m=p("select-base"),l=p("input-base"),s=p("text-area-base"),t=p("button-base");return w(),B("div",j,[r(m,{id:"id_area_revisora",label:"Contrato o Convenio de Colaboración",options:a.app.listConvenioContrato,class:"mb-3",modelValue:a.app.amendingAgreement.id_contrato_padre,"onUpdate:modelValue":n[0]||(n[0]=e=>a.app.amendingAgreement.id_contrato_padre=e),onChange:n[1]||(n[1]=e=>a.getInfoContrato())},null,8,["options","modelValue"]),r(m,{id:"id_numero_proyecto",label:"Número de proyecto (Cartera de Inversión)",options:a.app.listProyects,class:"mb-3",modelValue:a.app.amendingAgreement.id_proyecto,"onUpdate:modelValue":n[2]||(n[2]=e=>a.app.amendingAgreement.id_proyecto=e),disabled:""},null,8,["options","modelValue"]),r(m,{id:"id_contratista",label:"Contratista",options:a.app.listContratista,class:"mb-3",modelValue:a.app.amendingAgreement.id_contratista,"onUpdate:modelValue":n[3]||(n[3]=e=>a.app.amendingAgreement.id_contratista=e),disabled:""},null,8,["options","modelValue"]),r(m,{id:"id_empleado_maof",label:"Unidad MAOF",options:a.app.listReviewAreas,class:"mb-3",modelValue:a.app.amendingAgreement.id_area_revisora,"onUpdate:modelValue":n[4]||(n[4]=e=>a.app.amendingAgreement.id_area_revisora=e),disabled:""},null,8,["options","modelValue"]),r(l,{id:"numero_contrato",label:"Número de Convenio Modificatorio",type:"text",class:"mb-3",modelValue:a.app.amendingAgreement.numero_contrato,"onUpdate:modelValue":n[5]||(n[5]=e=>a.app.amendingAgreement.numero_contrato=e)},null,8,["modelValue"]),r(s,{id:"objeto_contrato",label:"Objeto",class:"mb-3",modelValue:a.app.amendingAgreement.objeto_contrato,"onUpdate:modelValue":n[6]||(n[6]=e=>a.app.amendingAgreement.objeto_contrato=e)},null,8,["modelValue"]),r(l,{id:"monto_sin_iva",label:"Monto sin IVA",type:"number",class:"mb-3",modelValue:a.app.amendingAgreement.monto_sin_iva,"onUpdate:modelValue":n[7]||(n[7]=e=>a.app.amendingAgreement.monto_sin_iva=e)},null,8,["modelValue"]),r(l,{id:"plazo_inicio",label:"Plazo (inicio)",type:"date",class:"mb-3",modelValue:a.app.amendingAgreement.plazo_inicio,"onUpdate:modelValue":n[8]||(n[8]=e=>a.app.amendingAgreement.plazo_inicio=e)},null,8,["modelValue"]),r(l,{id:"plazo_fin",label:"Plazo (fin)",type:"date",class:"mb-3",modelValue:a.app.amendingAgreement.plazo_fin,"onUpdate:modelValue":n[9]||(n[9]=e=>a.app.amendingAgreement.plazo_fin=e)},null,8,["modelValue"]),r(t,{label:"Guardar",onClick:a.sendForm,class:"mr-0 ml-auto"},null,8,["onClick"])])}const T=z(U,[["render",P]]);export{T as F};
