import{F as B}from"./FormResident-afc40fbc.js";import{A as w}from"./ArrowBack-a75f223a.js";import{T as x}from"./fetchApi-a406ff59.js";import{I as y}from"./InputBase-069e1973.js";import{T as g}from"./TableBase-f871c409.js";import{B as E}from"./ButtonBase-41bc6cfe.js";import{a as R,g as I,h as F,i as k}from"./residentEstimate-d735b473.js";import{_ as A,l as C,u as D,k as j,r as N,a as l,o as S,c as T,g as d,b as o,t as p}from"./index-4e9c12ea.js";import{S as i}from"./sweetalert2.all-281a79b7.js";import"./SelectBase-7bb38132.js";import"./reviewArea-d086d2f6.js";const q={name:"FilesResidentEstimate",components:{FormResident:B,ArrowBack:w,TitleBar:x,InputBase:y,TableBase:g,ButtonBase:E},setup(){const _=C(),r=D(),h=[{label:"Id",field:"id_archivo_estimacion"},{label:"Documentos Residente",field:"ruta_archivo_residente"},{label:"Descripción",field:"descripcion_archivo"}],e=j({file:{id_estimacion:"",file:"",descripcionFile:""},data:{},filesById:[],loading:!0}),m=N([]),v=async()=>{e.loading=!0;const{data:t}=await R(_.params.residentEstimateId);e.data=t,e.file.id_estimacion=t.id_estimacion,a.append("id_estimacion",e.file.id_estimacion),e.loading=!1,s()},s=async()=>{const{data:t}=await I(e.file.id_estimacion);m.value=t},f=async t=>{await updateResident(t),i.fire("¡Éxito!","Residente actualizado con éxito!","success"),r.push({name:"Resident"})};let a=new FormData;const u=async()=>{try{const{value:t}=await i.fire({title:"Select file",input:"file",showCancelButton:!0,reverseButtons:!0,inputAttributes:{accept:"pdf/*","aria-label":"Upload your profile picture"}});if(t!=null){const{value:c}=await i.fire({title:"Descripción del archivo",input:"text",showCancelButton:!0,reverseButtons:!0,inputValidator:n=>{if(!n)return"El campo es requerido"}});if(c!==void 0){e.file.descripcionFile=c,e.file.file=t,a.append("archivo_estimacion ",e.file.file),a.append("descripcion_archivo ",e.file.descripcionFile);try{await F(a),s(),i.fire("¡Éxito!","!Archivo guardado con éxito!","success"),e.file.file="",e.file.descripcionFile=""}catch(n){i.fire("Error",`${n.response.data.detail}`,"error")}}}else t===null&&i.fire("No selesccionaste ningun archivo","Agrega uno para continuar","warning")}catch{}},b=[{label:"Descargar",action:async t=>{window.open(`${t.archivo_estimacion}`,"_blank")}},{label:"Eliminar",action:async t=>{i.fire({title:"¿Estás seguro que desea inactivar el documento?",text:"Esto quitará el documento",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Si, Inactivar!",reverseButtons:!0}).then(async c=>{if(c.isConfirmed)try{await k(t.id_archivo_estimacion),await s(),i.fire("¡Inactivo!","El documento se inactivó","success")}catch(n){i.fire("Error",`${n.response.data.message}`,"error")}})}}];return v(),{app:e,filesById:m,saveResident:f,featureOptions:b,formData:a,headers:h,fileUpload:u}}},O={class:"px-4 mt-10"},U={class:"px-4"},V={class:"flex flex-row justify-between"},z={class:"font-bold text-lg"},$={class:"font-bold text-lg w-128 text-center"},G={class:"flex content-start justify-end items-center mb-10"},H={class:"items-center justify-center"},J=o("h1",{class:"font-bold text-lg text-center"}," Número de la Estimación ",-1),K={class:"text-center font-semibold text-lg numEstimacion"};function L(_,r,h,e,m,v){const s=l("arrow-back"),f=l("title-bar"),a=l("button-base"),u=l("table-base");return S(),T("main",O,[d(s),d(f,{title:"Estimación Residente",subtitle:"Archivos"}),o("section",U,[o("div",V,[o("div",z,p(e.app.data.numero_contrato),1),o("div",$," Objeto: "+p(e.app.data.objeto_contrato),1),o("div",G,[o("div",H,[J,o("p",K,p(e.app.data.num_consecutivo_estimacion),1)])])]),d(a,{label:"Nuevo",onClick:r[0]||(r[0]=b=>e.fileUpload()),class:"mr-0 ml-auto mb-5"}),d(u,{options:e.featureOptions,headers:e.headers,data:e.filesById},null,8,["options","headers","data"])])])}const ae=A(q,[["render",L]]);export{ae as default};
