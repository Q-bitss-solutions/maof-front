import{T as M}from"./TableUsers-f4a3d3b4.js";import{A as P}from"./ArrowBack-88dce955.js";import{H as U}from"./HomePage-0a8320d9.js";import{S as A}from"./SelectBase-d25e08a6.js";import{B as j}from"./ButtonBase-1debdcdc.js";import{_ as I,k as S,a as m,o as _,c as k,g as r,b as l,u as T,r as B,t as C,f as V,e as h,n as O}from"./index-86ce7909.js";import{f as N,T as R}from"./fetchApi-9e5fb38d.js";import{I as z}from"./InputBase-f103e138.js";import{S as q}from"./sweetalert2.all-281a79b7.js";import{b as H}from"./project-1af93fc0.js";import{f as G}from"./contract-0fb2f473.js";import{c as J}from"./consultas-dd0b2ae3.js";const K={name:"FormProject",props:{editMode:{type:Boolean,default:!1},project:{type:Object,default:()=>({})}},components:{InputBase:z,ButtonBase:j,SelectBase:A},setup(d,{emit:o}){const c=S({busqueda:{c_cc_cm:"",resident:"",mesEstimacion:"",anioEstimacion:"",estatusEstimacion:"",unitMAOF:"",diasInicio:"",diasFin:"",fechaInicio:"",fechaFin:""}});return d.editMode&&(c.project=d.project,console.log(d.project),c.project.fecha_inicio_proyecto=d.project.fecha_inicio_proyecto.split("-").reverse().join("-"),c.project.fecha_fin_proyecto===null?c.project.fecha_fin_proyecto="":c.project.fecha_fin_proyecto=d.project.fecha_fin_proyecto.split("-").reverse().join("-")),{app:c,sendForm:()=>o("submit",c.busqueda)}}},L={class:"max-w-6xl pb-10 grow"},Q={class:"grid grid-cols-2"},W={class:"grid grid-cols-2 pt-3"},X=l("p",null,"*Contrato, Convenio de Colaboración, Convenio Modificatorio",-1);function Y(d,o,c,e,b,x){const p=m("select-base"),f=m("input-base"),v=m("button-base");return _(),k("div",L,[r(p,{id:"clave_cartera",label:"C, CC, CM*",class:"mb-3",modelValue:e.app.busqueda.c_cc_cm,"onUpdate:modelValue":o[0]||(o[0]=a=>e.app.busqueda.c_cc_cm=a)},null,8,["modelValue"]),r(p,{id:"nombre_proyecto",label:"Residente",class:"mb-3",modelValue:e.app.busqueda.resident,"onUpdate:modelValue":o[1]||(o[1]=a=>e.app.busqueda.resident=a)},null,8,["modelValue"]),r(p,{id:"nombre_proyecto",label:"Mes de la estimación",class:"mb-3",modelValue:e.app.busqueda.mesEstimacion,"onUpdate:modelValue":o[2]||(o[2]=a=>e.app.busqueda.mesEstimacion=a)},null,8,["modelValue"]),r(p,{id:"nombre_proyecto",label:"Año de la Estimación",class:"mb-3",modelValue:e.app.busqueda.anioEstimacion,"onUpdate:modelValue":o[3]||(o[3]=a=>e.app.busqueda.anioEstimacion=a)},null,8,["modelValue"]),r(p,{id:"nombre_proyecto",label:"Estatus de la Estimación",class:"mb-3",modelValue:e.app.busqueda.estatusEstimacion,"onUpdate:modelValue":o[4]||(o[4]=a=>e.app.busqueda.estatusEstimacion=a)},null,8,["modelValue"]),r(p,{id:"nombre_proyecto",label:"Unidad MAOF responsable",class:"mb-3",modelValue:e.app.busqueda.unitMAOF,"onUpdate:modelValue":o[5]||(o[5]=a=>e.app.busqueda.unitMAOF=a)},null,8,["modelValue"]),l("div",Q,[r(f,{id:"dias_inicio",label:"Días transcurridos del",type:"number",class:"grow",modelValue:e.app.busqueda.diasInicio,"onUpdate:modelValue":o[6]||(o[6]=a=>e.app.busqueda.diasInicio=a)},null,8,["modelValue"]),r(f,{id:"dias_fin",label:"al",type:"number",class:"flex-auto",modelValue:e.app.busqueda.diasFin,"onUpdate:modelValue":o[7]||(o[7]=a=>e.app.busqueda.diasFin=a)},null,8,["modelValue"])]),l("div",W,[r(f,{id:"fecha_inicio",label:"Autorización entre",type:"date",class:"grow",modelValue:e.app.busqueda.fechaInicio,"onUpdate:modelValue":o[8]||(o[8]=a=>e.app.busqueda.fechaInicio=a)},null,8,["modelValue"]),r(f,{id:"fecha_fin",label:"y",type:"date",class:"",modelValue:e.app.busqueda.fechaFin,"onUpdate:modelValue":o[9]||(o[9]=a=>e.app.busqueda.fechaFin=a)},null,8,["modelValue"])]),r(v,{label:"Buscar",onClick:e.sendForm,class:"mr-0 ml-auto mt-5"},null,8,["onClick"]),X])}const Z=I(K,[["render",Y]]),E=d=>N({url:"/agenda_estimacion/filtros/",method:"GET",params:d||{}}),$="/maof-front/assets/Filter-fb6d2bbc.png",ee="/maof-front/assets/Search-94489079.png";const oe={name:"UsersRolesMAOFIndex",components:{TableBase:M,ArrowBack:P,HomePage:U,ButtonBase:j,TitleBar:R,SelectBase:A,FormConsultaBusqueda:Z},setup(){const d=T(),o=J(),c=[{label:"Id",field:"empleado_maof"}],e=B({filtro:{tipoDocumento:"",listFiltros:[{value:2,label:"Contrato o Convenio de Colaboración"},{value:3,label:"Convenio Modificatorio"},{value:1,label:"Proyecto / Cartera de inversión"}],listDocsFiltrados:[],filtroDocValue:"",data:{pendientes:[],pagados:[],totales:[]}},loading:!0});let b=B(!1);const x=[],p=(t,s)=>{switch(s){case"pendientes":t.length>0?(o.addPendientes(t),d.push({name:"ConsultasPedientesMAOF"})):(console.log("No hay estimaciones pendientes"),q.fire("No hay estimaciones","Intenta con otro filtro","warning"));break;case"pagadas":t.length>0?(o.addPagados(t),d.push({name:"ConsultasPagadosMAOF"})):(console.log("No hay estimaciones pagadas"),q.fire("No hay estimaciones","Intenta con otro filtro","warning"));break;case"totales":t.length>0?(o.addTotal(t),d.push({name:"ConsultasTotalesMAOF"})):(console.log("No hay estimaciones totales"),q.fire("No hay estimaciones","Intenta con otro filtro","warning"));break;default:console.log("opcion invalida");break}},f=async t=>{switch(b.value===!0&&(b.value=!1),t){case"1":e.value.filtro.listDocsFiltrados=[],e.value.filtro.filtroDocValue="",v();break;case"2":e.value.filtro.listDocsFiltrados=[],e.value.filtro.filtroDocValue="",a(t);break;case"3":e.value.filtro.listDocsFiltrados=[],e.value.filtro.filtroDocValue="",a(t);break;case"4":e.value.filtro.listDocsFiltrados=[],e.value.filtro.filtroDocValue="";break;default:console.log("No se encontro nada");break}},v=async()=>{const{data:t}=await H();e.value.filtro.listDocsFiltrados=t.map(s=>({value:s.id_proyecto,label:`${s.clave_cartera}-${s.nombre_proyecto}`}))},a=async t=>{const{data:s}=await G();t==="2"&&s.forEach(i=>{i.id_tipo_contrato!==3&&(e.value.filtro.listDocsFiltrados.push({value:i.id_contrato,label:i.numero_contrato}),e.value.filtro.listDocsFiltrados.sort((n,y)=>n.label>y.label?1:n.label<y.label?-1:0))}),t==="3"&&s.forEach(i=>{i.id_tipo_contrato===3&&(e.value.filtro.listDocsFiltrados.push({value:i.id_contrato,label:i.numero_contrato}),e.value.filtro.listDocsFiltrados.sort((n,y)=>n.label>y.label?1:n.label<y.label?-1:0))})},g=()=>{e.value.filtro.tipoDocumento="",e.value.filtro.filtroDocValue="",b.value=!b.value},F=async t=>{console.log("Criterios de busqueda: ",t),g()},u=async(t,s)=>{e.value.loading=!0;let i={};s==="1"?i={id_proyecto:t}:(s==="2"||s==="3")&&(i={id_contrato:t});const{data:n}=await E(i);e.value.filtro.data.totales=n.total,e.value.filtro.data.pagados=n.pagadas,e.value.filtro.data.pendientes=n.pendiente,D(n.pendiente,n.pagadas,n.total),e.value.loading=!1},D=(t,s,i)=>{o.addPendientes(t),o.addPagados(s),o.addTotal(i)},w=async()=>{e.value.loading=!0;let t=[],s=[];const{data:i}=await E();i.forEach(n=>{n.estatus_semaforo!=="Pago Efectuado"?s.push(n):t.push(n)}),e.value.filtro.data.totales=i,e.value.filtro.data.pagados=t,e.value.filtro.data.pendientes=s,D(s,t,i),e.value.loading=!1};return w(),{app:e,featureOptions:x,headers:c,showBusquedaValue:b,getStatusEstimations:p,showBusqueda:g,saveBusqueda:F,saveFiltro:u,getDocsByType:f,getProjects:v,getContracts:a,getFiltroDefault:w,infoToStore:D}}},ae={class:"px-4 mt-10"},te={class:"flex justify-between"},le={class:"px-4"},se={key:0,class:"flex justify-center text-3xl"},ie={class:"text-center"},ne=l("h1",{class:"text-center"},"Pendientes",-1),re={class:"text-center"},de=l("h1",{class:"text-center"},"Pagadas",-1),ce={class:"text-center"},ue=l("h1",{class:"text-center"},"Total",-1),pe={class:"flex flex-col mt-20"},me={class:"flex justify-start items-center pb-10"},fe=l("img",{src:$,alt:"filter",class:"w-10 items-center"},null,-1),be={class:"flex justify-start items-center pt-10"},_e=l("img",{src:ee,alt:"filter",class:"w-10 items-center"},null,-1),ve=l("h1",{class:"text-center font-bold text-lg"},"Búsqueda",-1),ge={class:"flex justify-center"};function ye(d,o,c,e,b,x){const p=m("arrow-back"),f=m("home-page"),v=m("title-bar"),a=m("select-base"),g=m("button-base"),F=m("form-consulta-busqueda");return _(),k("main",ae,[l("div",te,[r(p),r(f)]),r(v,{title:"Consulta MAOF",subtitle:"Agenda de Estimaciones"}),l("section",le,[e.app.loading?V("",!0):(_(),k("div",se,[l("div",{class:"px-10 text-red cursor-pointer",onClick:o[0]||(o[0]=u=>e.getStatusEstimations(e.app.filtro.data.pendientes,"pendientes"))},[l("p",ie,C(e.app.filtro.data.pendientes.length),1),ne]),l("div",{class:"px-10 text-green cursor-pointer",onClick:o[1]||(o[1]=u=>e.getStatusEstimations(e.app.filtro.data.pagados,"pagadas"))},[l("p",re,C(e.app.filtro.data.pagados.length),1),de]),l("div",{class:"px-10 cursor-pointer",onClick:o[2]||(o[2]=u=>e.getStatusEstimations(e.app.filtro.data.totales,"totales"))},[l("p",ce,C(e.app.filtro.data.totales.length),1),ue])])),l("div",pe,[l("div",me,[fe,r(a,{label:"Filtros",class:"text-center w-48 mr-10",id:"filtros",options:e.app.filtro.listFiltros,modelValue:e.app.filtro.tipoDocumento,"onUpdate:modelValue":o[3]||(o[3]=u=>e.app.filtro.tipoDocumento=u),onChange:o[4]||(o[4]=u=>e.getDocsByType(e.app.filtro.tipoDocumento))},null,8,["options","modelValue"]),e.app.filtro.listDocsFiltrados!=""&&e.app.filtro.tipoDocumento!==""?(_(),h(a,{key:0,label:"",class:"text-center w-48 ml-36",id:"filtrosDocs",options:e.app.filtro.listDocsFiltrados,modelValue:e.app.filtro.filtroDocValue,"onUpdate:modelValue":o[5]||(o[5]=u=>e.app.filtro.filtroDocValue=u)},null,8,["options","modelValue"])):V("",!0),e.app.filtro.listDocsFiltrados!=""&&e.app.filtro.tipoDocumento!==""?(_(),h(g,{key:1,label:"Aplicar",class:O(["border-gray text-black hover:bg-white hover:text-red",{"ml-[36rem]":e.app.filtro.tipoDocumento==="1"," ml-[3.7rem]":e.app.filtro.tipoDocumento!=="1"&&e.app.filtro.filtroDocValue===""," ml-[0rem]":e.app.filtro.tipoDocumento!=="1"&&e.app.filtro.filtroDocValue!==""}]),onClick:o[6]||(o[6]=u=>e.saveFiltro(e.app.filtro.filtroDocValue,e.app.filtro.tipoDocumento)),disabled:e.app.filtro.filtroDocValue===""},null,8,["class","disabled"])):V("",!0),e.app.filtro.tipoDocumento==="4"?(_(),h(g,{key:2,label:"Aplicar",class:"ml-40 border-gray text-black hover:bg-white hover:text-red",onClick:o[7]||(o[7]=u=>d.esperandoAccion())})):V("",!0)]),l("div",be,[_e,ve,r(g,{label:"Criterio de búsqueda",class:"ml-5 border-gray text-black hover:bg-white hover:text-red",onClick:e.showBusqueda},null,8,["onClick"])])]),l("div",ge,[e.showBusquedaValue?(_(),h(F,{key:0,onSubmit:e.saveBusqueda,class:"mt-20"},null,8,["onSubmit"])):V("",!0)])])])}const je=I(oe,[["render",ye]]);export{je as default};
